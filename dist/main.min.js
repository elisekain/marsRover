"use strict";document.addEventListener("DOMContentLoaded",function(){function a(a,d,e){if(!a.length){d=d.replace(/\w\S*/g,b);var i="\n\t\t\t\tNo Photos Found for \n\t\t\t\t<span>"+d+"</span> on \n\t\t\t\t<span>"+e+"</span>\n\t\t\t";return c(i)}var f=document.getElementById("photoTable"),g=document.getElementById("photoTableBody"),h=document.getElementById("blankState");g.innerHTML="",a.map(function(a){g.innerHTML+="\n\t\t\t<tr>\n\t\t\t\t<td class=\"col-4\">"+a.id+"</td>\n\t\t\t\t<td class=\"col-4\">"+a.sol+"</td>\n\t\t\t\t<td class=\"col-4\">\n\t\t\t\t\t<a href="+a.img_src+" target=\"_blank\">\n\t\t\t\t\t\t<img src="+a.img_src+" alt=\""+d+" rover picture "+a.id+"\"/>\n\t\t\t\t\t</a>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t"}),f.style.display="table",h.style.display="none"}function b(a){return a.charAt(0).toUpperCase()+a.substr(1)}function c(a){var b=document.getElementById("errorMsg");b.innerHTML=a,b.style.display="block"}function d(){var a=document.getElementById("errorMsg");a.style.display="none"}function f(){d();var a=document.getElementById("photoTable"),b=document.getElementById("blankState");a.style.display="none",b.style.display="block"}function e(a,b){a&&(b=a.target.value);b&&(m.set("minDate",new Date(k[b].minDate).fp_incr(1)),m.set("maxDate",new Date(k[b].maxDate).fp_incr(1)),m.setDate(new Date(k[b].maxDate).fp_incr(1)))}function g(){document.getElementById("searchIcon").style.display="none",document.getElementById("loadIcon").style.display="inline-block"}function h(){document.getElementById("searchIcon").style.display="inline-block",document.getElementById("loadIcon").style.display="none"}var i="https://api.nasa.gov/mars-photos/api/v1",j="api_key="+(window.API_KEY?window.API_KEY:"DEMO_KEY");console.log(window.config+"!!!");var k={curiosity:null,opportunity:null,spirit:null};(function(){Object.keys(k).map(function(a){fetch(i+"/manifests/"+a+"/?"+j).then(function(a){return a.json()}).then(function(a){if(a.photo_manifest)return a;throw new Error(a.error?a.error.message:"Network response was not ok")}).then(function(c){var d=c.photo_manifest;if(k[a]={minDate:d.landing_date,maxDate:d.max_date},a===document.getElementById("rovers").value){e(null,a);var f=a.replace(/\w\S*/g,b),g=m.formatDate(m.parseDate(k[a].maxDate),"F j, Y");document.getElementById("suggestedSearch").innerHTML="\n\t\t\t\t\t\t\tTry searching for\n\t\t\t\t\t\t\t<span>"+f+"</span> on \n\t\t\t\t\t\t\t<span>"+g+"</span>\n\t\t\t\t\t\t"}}).catch(function(a){c("Error from Mars Rover API: <span>"+a.message+"</span>"),console.log("Error: "+a.message)})})})();var l=new Date,m=flatpickr("#earthDate",{altInput:!0,minDate:new Date("January 1, 2004 0:0:00"),maxDate:l});document.getElementById("searchForPhotos").addEventListener("submit",function(b){b.preventDefault(),f();var d=b.target[0].value,e=b.target[1].value;return e?void(g(),fetch(i+"/rovers/"+d+"/photos?earth_date="+e+"&page=1&"+j).then(function(a){return a.json()}).then(function(a){if(h(),a.photos)return a;throw new Error(a.error?a.error.message:"Network response was not ok")}).then(function(b){a(b.photos,d,e)}).catch(function(a){h(),c("Error from Mars Rover API: <span>"+a.message+"</span>"),console.log("Error: "+a.message)})):c("No Earth Date Selected")}),document.getElementById("rovers").addEventListener("change",e)});
